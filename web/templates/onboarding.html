<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tell us about you - Blanca</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body class="auth-body">
    <div class="auth-page">
        <div class="auth-top-bar">
            <button id="theme-toggle" type="button" class="btn btn-ghost" title="Toggle dark mode">ðŸŒ™</button>
        </div>
        <div class="auth-card">
            <h1>Hi {{ username }}!</h1>
            <p class="auth-subtitle">Before we start, tell us a bit about yourself. This helps us track sessions consistently across participants.</p>
            <form method="post" action="{{ url_for('onboarding') }}" class="auth-form">
                {% if errors %}
                <div class="auth-errors">
                    <strong>We need a few more details:</strong>
                    <ul>
                        {% for error in errors %}
                        <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}

                <div>
                    <label for="first_name">First Name</label>
                    <input type="text" id="first_name" name="first_name" class="auth-input" value="{{ form_data.first_name }}" required>
                </div>
                <div>
                    <label for="last_name">Last Name</label>
                    <input type="text" id="last_name" name="last_name" class="auth-input" value="{{ form_data.last_name }}" required>
                </div>
                <div>
                    <label for="gender">Gender</label>
                    <input type="text" id="gender" name="gender" class="auth-input" value="{{ form_data.gender }}" placeholder="e.g., Woman">
                </div>
                <div>
                    <label for="pronouns">Pronouns</label>
                    <input type="text" id="pronouns" name="pronouns" class="auth-input" value="{{ form_data.pronouns }}" placeholder="e.g., she/her">
                </div>
                <div>
                    <label for="ethnicity">Ethnicity</label>
                    <input type="text" id="ethnicity" name="ethnicity" class="auth-input" value="{{ form_data.ethnicity }}" required>
                </div>
                <div>
                    <label for="age_range">Age Range</label>
                    <select id="age_range" name="age_range" class="auth-select">
                        <option value="">Prefer not to say</option>
                        {% set ranges = ["18-24", "25-34", "35-44", "45-54", "55-64", "65+"] %}
                        {% for age in ranges %}
                        <option value="{{ age }}" {% if form_data.age_range == age %}selected{% endif %}>{{ age }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="auth-full-width">
                    <label for="email">Email Address (will be hashed)</label>
                    <input type="email" id="email" name="email" class="auth-input" value="{{ form_data.email }}" placeholder="participant@example.com" required>
                </div>
                <div class="auth-actions">
                    <a href="{{ url_for('logout') }}" class="btn btn-ghost" style="text-decoration:none;">Cancel</a>
                    <button type="submit" class="btn btn-primary">Save &amp; Continue</button>
                </div>
            </form>
        </div>
    </div>
    <script>
    (function initTheme(){
        const root = document.documentElement;
        const toggleBtn = document.getElementById('theme-toggle');
        const saved = localStorage.getItem('theme') || 'light';
        if (saved === 'dark') {
            root.setAttribute('data-theme', 'dark');
        }
        function setIcon() {
            if (!toggleBtn) return;
            toggleBtn.textContent = root.getAttribute('data-theme') === 'dark' ? 'â˜€ï¸' : 'ðŸŒ™';
        }
        setIcon();
        toggleBtn?.addEventListener('click', () => {
            const isDark = root.getAttribute('data-theme') === 'dark';
            const next = isDark ? 'light' : 'dark';
            if (next === 'dark') {
                root.setAttribute('data-theme', 'dark');
            } else {
                root.removeAttribute('data-theme');
            }
            localStorage.setItem('theme', next);
            setIcon();
        });
    })();
    </script>
</body>
</html>
